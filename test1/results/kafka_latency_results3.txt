======================================================================
KAFKA - RELAT√ìRIO DE LAT√äNCIA END-TO-END
======================================================================

üìñ EXPLICA√á√ÉO DA MEDI√á√ÉO:
----------------------------------------------------------------------
Este teste mede a LAT√äNCIA END-TO-END, que inclui:

  T0 ‚Üí Cria√ß√£o da mensagem no PRODUCER
       - Marca o timestamp antes da serializa√ß√£o JSON
       - Armazenado no campo 'timestamp_ms' da mensagem

  T1 ‚Üí Serializa√ß√£o JSON no producer
       - Convers√£o do dict Python para JSON bytes
       - Feita automaticamente pelo value_serializer

  T2 ‚Üí Envio pela rede + Processamento no Kafka
       - Transmiss√£o TCP/IP (localhost)
       - Persist√™ncia em disco (acks='all')
       - Replica√ß√£o entre brokers (se houver r√©plicas)
       - Armazenamento em parti√ß√£o/offset

  T3 ‚Üí Recebimento RAW no CONSUMER
       - Timestamp capturado ANTES da desserializa√ß√£o
       - Este √© o ponto final da medi√ß√£o
       - IMPORTANTE: value_deserializer=None para controlar isso!

  T4 ‚Üí Desserializa√ß√£o JSON no consumer
       - N√ÉO inclu√≠do na lat√™ncia end-to-end
       - Desserializa√ß√£o manual com json.loads()
       - Medido separadamente para an√°lise

LAT√äNCIA END-TO-END = T3 - T0
(Tempo total desde cria√ß√£o at√© recebimento, sem processamento)
======================================================================

üìä RESUMO ESTAT√çSTICO
----------------------------------------------------------------------
Total de mensagens: 100
Lat√™ncia m√©dia: 5.14 ms
Lat√™ncia m√≠nima: 2.11 ms
Lat√™ncia m√°xima: 108.52 ms
Mediana: 3.82 ms
Desvio padr√£o: 10.54 ms

Percentis:
  P50: 3.83 ms
  P90: 6.52 ms
  P95: 7.35 ms
  P99: 108.52 ms

======================================================================

üìã DADOS DETALHADOS (FORMATO DATAFRAME)
----------------------------------------------------------------------
  ID |     T0_Creation |      T3_Receive |     T4_Deserial |    Latency |   Deserial |      Total | Part | Offset
----------------------------------------------------------------------
   0 | 1760998924995.501 | 1760998925104.022 | 1760998925104.045 |    108.521 |      0.022 |    108.544 |    0 |    200
   1 | 1760998925102.688 | 1760998925106.238 | 1760998925106.259 |      3.550 |      0.020 |      3.570 |    0 |    201
   2 | 1760998925105.054 | 1760998925108.495 | 1760998925108.524 |      3.441 |      0.028 |      3.470 |    0 |    202
   3 | 1760998925107.417 | 1760998925110.814 | 1760998925110.833 |      3.397 |      0.018 |      3.416 |    0 |    203
   4 | 1760998925109.714 | 1760998925113.102 | 1760998925113.119 |      3.389 |      0.016 |      3.405 |    0 |    204
   5 | 1760998925111.735 | 1760998925115.219 | 1760998925115.236 |      3.484 |      0.017 |      3.501 |    0 |    205
   6 | 1760998925114.499 | 1760998925117.539 | 1760998925117.566 |      3.041 |      0.026 |      3.067 |    0 |    206
   7 | 1760998925116.935 | 1760998925119.293 | 1760998925119.310 |      2.359 |      0.016 |      2.375 |    0 |    207
   8 | 1760998925118.520 | 1760998925121.151 | 1760998925121.173 |      2.631 |      0.022 |      2.654 |    0 |    208
   9 | 1760998925120.275 | 1760998925123.000 | 1760998925123.020 |      2.725 |      0.019 |      2.745 |    0 |    209
  10 | 1760998925122.201 | 1760998925124.952 | 1760998925124.977 |      2.750 |      0.024 |      2.775 |    0 |    210
  11 | 1760998925124.595 | 1760998925127.479 | 1760998925127.496 |      2.883 |      0.017 |      2.900 |    0 |    211
  12 | 1760998925127.026 | 1760998925129.649 | 1760998925129.673 |      2.623 |      0.024 |      2.647 |    0 |    212
  13 | 1760998925129.556 | 1760998925132.401 | 1760998925132.450 |      2.845 |      0.046 |      2.894 |    0 |    213
  14 | 1760998925132.154 | 1760998925136.128 | 1760998925136.150 |      3.974 |      0.021 |      3.996 |    0 |    214
  15 | 1760998925135.372 | 1760998925138.398 | 1760998925138.424 |      3.026 |      0.025 |      3.052 |    0 |    215
  16 | 1760998925137.460 | 1760998925140.572 | 1760998925140.599 |      3.113 |      0.026 |      3.139 |    0 |    216
  17 | 1760998925139.511 | 1760998925143.462 | 1760998925143.493 |      3.951 |      0.031 |      3.982 |    0 |    217
  18 | 1760998925141.813 | 1760998925149.503 | 1760998925149.532 |      7.690 |      0.028 |      7.719 |    0 |    218
  19 | 1760998925144.634 | 1760998925152.172 | 1760998925152.195 |      7.539 |      0.022 |      7.562 |    0 |    219
  20 | 1760998925149.712 | 1760998925155.126 | 1760998925155.152 |      5.414 |      0.025 |      5.439 |    0 |    220
  21 | 1760998925152.017 | 1760998925157.600 | 1760998925157.628 |      5.583 |      0.028 |      5.612 |    0 |    221
  22 | 1760998925154.939 | 1760998925161.457 | 1760998925161.494 |      6.518 |      0.035 |      6.554 |    0 |    222
  23 | 1760998925157.687 | 1760998925164.929 | 1760998925164.957 |      7.242 |      0.026 |      7.269 |    0 |    223
  24 | 1760998925160.841 | 1760998925167.605 | 1760998925167.635 |      6.764 |      0.028 |      6.794 |    0 |    224
  25 | 1760998925165.031 | 1760998925170.363 | 1760998925170.381 |      5.332 |      0.018 |      5.350 |    0 |    225
  26 | 1760998925168.082 | 1760998925172.326 | 1760998925172.341 |      4.244 |      0.014 |      4.259 |    0 |    226
  27 | 1760998925170.210 | 1760998925174.657 | 1760998925174.690 |      4.447 |      0.032 |      4.480 |    0 |    227
  28 | 1760998925172.264 | 1760998925178.410 | 1760998925178.446 |      6.146 |      0.035 |      6.182 |    0 |    228
  29 | 1760998925175.054 | 1760998925181.375 | 1760998925181.491 |      6.321 |      0.115 |      6.437 |    0 |    229
  30 | 1760998925178.322 | 1760998925184.732 | 1760998925184.761 |      6.411 |      0.028 |      6.439 |    0 |    230
  31 | 1760998925181.006 | 1760998925187.032 | 1760998925187.062 |      6.026 |      0.029 |      6.055 |    0 |    231
  32 | 1760998925185.750 | 1760998925188.715 | 1760998925188.734 |      2.965 |      0.019 |      2.984 |    0 |    232
  33 | 1760998925188.188 | 1760998925190.599 | 1760998925190.620 |      2.411 |      0.021 |      2.433 |    0 |    233
  34 | 1760998925190.508 | 1760998925193.090 | 1760998925193.112 |      2.582 |      0.021 |      2.603 |    0 |    234
  35 | 1760998925192.793 | 1760998925196.922 | 1760998925196.950 |      4.129 |      0.027 |      4.158 |    0 |    235
  36 | 1760998925195.881 | 1760998925200.203 | 1760998925200.230 |      4.322 |      0.027 |      4.350 |    0 |    236
  37 | 1760998925200.183 | 1760998925203.667 | 1760998925203.692 |      3.484 |      0.024 |      3.509 |    0 |    237
  38 | 1760998925202.683 | 1760998925205.565 | 1760998925205.590 |      2.882 |      0.024 |      2.907 |    0 |    238
  39 | 1760998925204.608 | 1760998925209.041 | 1760998925209.063 |      4.433 |      0.022 |      4.455 |    0 |    239
  40 | 1760998925208.218 | 1760998925213.247 | 1760998925213.278 |      5.029 |      0.030 |      5.060 |    0 |    240
  41 | 1760998925211.600 | 1760998925216.443 | 1760998925216.515 |      4.843 |      0.070 |      4.915 |    0 |    241
  42 | 1760998925214.774 | 1760998925218.604 | 1760998925218.623 |      3.831 |      0.018 |      3.849 |    0 |    242
  43 | 1760998925217.281 | 1760998925220.549 | 1760998925220.576 |      3.268 |      0.026 |      3.295 |    0 |    243
  44 | 1760998925219.612 | 1760998925222.546 | 1760998925222.573 |      2.935 |      0.026 |      2.961 |    0 |    244
  45 | 1760998925221.595 | 1760998925225.441 | 1760998925225.467 |      3.846 |      0.026 |      3.872 |    0 |    245
  46 | 1760998925224.159 | 1760998925227.270 | 1760998925227.332 |      3.110 |      0.061 |      3.172 |    0 |    246
  47 | 1760998925226.486 | 1760998925229.237 | 1760998925229.253 |      2.751 |      0.016 |      2.768 |    0 |    247
  48 | 1760998925228.817 | 1760998925231.314 | 1760998925231.341 |      2.497 |      0.026 |      2.523 |    0 |    248
  49 | 1760998925231.140 | 1760998925236.224 | 1760998925236.243 |      5.084 |      0.018 |      5.103 |    0 |    249
  50 | 1760998925234.763 | 1760998925238.776 | 1760998925238.802 |      4.013 |      0.025 |      4.039 |    0 |    250
  51 | 1760998925237.489 | 1760998925242.212 | 1760998925242.240 |      4.723 |      0.027 |      4.751 |    0 |    251
  52 | 1760998925242.224 | 1760998925246.528 | 1760998925246.557 |      4.304 |      0.028 |      4.333 |    0 |    252
  53 | 1760998925245.493 | 1760998925250.061 | 1760998925250.086 |      4.568 |      0.025 |      4.594 |    0 |    253
  54 | 1760998925249.660 | 1760998925252.107 | 1760998925252.129 |      2.447 |      0.022 |      2.469 |    0 |    254
  55 | 1760998925251.888 | 1760998925258.652 | 1760998925258.692 |      6.764 |      0.040 |      6.804 |    0 |    255
  56 | 1760998925254.242 | 1760998925261.589 | 1760998925261.607 |      7.348 |      0.017 |      7.365 |    0 |    256
  57 | 1760998925256.269 | 1760998925261.661 | 1760998925261.667 |      5.392 |      0.007 |      5.398 |    0 |    257
  58 | 1760998925261.176 | 1760998925263.296 | 1760998925263.315 |      2.120 |      0.018 |      2.139 |    0 |    258
  59 | 1760998925263.091 | 1760998925267.184 | 1760998925267.213 |      4.093 |      0.029 |      4.122 |    0 |    259
  60 | 1760998925265.286 | 1760998925271.085 | 1760998925271.145 |      5.799 |      0.059 |      5.858 |    0 |    260
  61 | 1760998925269.560 | 1760998925273.208 | 1760998925273.233 |      3.649 |      0.024 |      3.673 |    0 |    261
  62 | 1760998925272.735 | 1760998925279.365 | 1760998925279.382 |      6.630 |      0.016 |      6.647 |    0 |    262
  63 | 1760998925276.367 | 1760998925282.116 | 1760998925282.138 |      5.749 |      0.022 |      5.771 |    0 |    263
  64 | 1760998925279.275 | 1760998925284.287 | 1760998925284.313 |      5.012 |      0.026 |      5.039 |    0 |    264
  65 | 1760998925281.583 | 1760998925284.391 | 1760998925284.399 |      2.808 |      0.008 |      2.816 |    0 |    265
  66 | 1760998925284.146 | 1760998925287.240 | 1760998925287.266 |      3.094 |      0.025 |      3.120 |    0 |    266
  67 | 1760998925285.998 | 1760998925289.422 | 1760998925289.444 |      3.424 |      0.021 |      3.446 |    0 |    267
  68 | 1760998925288.359 | 1760998925292.415 | 1760998925292.435 |      4.055 |      0.020 |      4.075 |    0 |    268
  69 | 1760998925290.452 | 1760998925294.762 | 1760998925294.786 |      4.310 |      0.024 |      4.334 |    0 |    269
  70 | 1760998925293.144 | 1760998925296.769 | 1760998925296.795 |      3.625 |      0.025 |      3.651 |    0 |    270
  71 | 1760998925295.386 | 1760998925299.068 | 1760998925299.086 |      3.681 |      0.018 |      3.699 |    0 |    271
  72 | 1760998925297.399 | 1760998925301.728 | 1760998925301.753 |      4.329 |      0.024 |      4.354 |    0 |    272
  73 | 1760998925300.346 | 1760998925304.046 | 1760998925304.073 |      3.700 |      0.026 |      3.727 |    0 |    273
  74 | 1760998925302.685 | 1760998925306.890 | 1760998925306.917 |      4.205 |      0.027 |      4.232 |    0 |    274
  75 | 1760998925305.259 | 1760998925309.324 | 1760998925309.351 |      4.065 |      0.027 |      4.092 |    0 |    275
  76 | 1760998925307.673 | 1760998925311.510 | 1760998925311.541 |      3.837 |      0.030 |      3.868 |    0 |    276
  77 | 1760998925309.520 | 1760998925314.270 | 1760998925314.301 |      4.750 |      0.030 |      4.781 |    0 |    277
  78 | 1760998925312.831 | 1760998925318.405 | 1760998925318.426 |      5.575 |      0.020 |      5.595 |    0 |    278
  79 | 1760998925317.431 | 1760998925320.257 | 1760998925320.279 |      2.826 |      0.022 |      2.849 |    0 |    279
  80 | 1760998925319.372 | 1760998925322.289 | 1760998925322.350 |      2.918 |      0.059 |      2.978 |    0 |    280
  81 | 1760998925321.322 | 1760998925324.708 | 1760998925324.735 |      3.386 |      0.026 |      3.413 |    0 |    281
  82 | 1760998925324.020 | 1760998925326.639 | 1760998925326.665 |      2.619 |      0.026 |      2.646 |    0 |    282
  83 | 1760998925326.733 | 1760998925330.172 | 1760998925330.200 |      3.439 |      0.027 |      3.467 |    0 |    283
  84 | 1760998925329.242 | 1760998925332.016 | 1760998925332.032 |      2.775 |      0.016 |      2.791 |    0 |    284
  85 | 1760998925331.078 | 1760998925333.551 | 1760998925333.572 |      2.473 |      0.020 |      2.494 |    0 |    285
  86 | 1760998925332.705 | 1760998925335.759 | 1760998925335.783 |      3.054 |      0.024 |      3.078 |    0 |    286
  87 | 1760998925334.494 | 1760998925338.030 | 1760998925338.057 |      3.536 |      0.026 |      3.563 |    0 |    287
  88 | 1760998925336.819 | 1760998925340.758 | 1760998925340.787 |      3.939 |      0.028 |      3.968 |    0 |    288
  89 | 1760998925338.857 | 1760998925342.841 | 1760998925342.866 |      3.984 |      0.024 |      4.009 |    0 |    289
  90 | 1760998925342.179 | 1760998925347.340 | 1760998925347.366 |      5.161 |      0.026 |      5.187 |    0 |    290
  91 | 1760998925345.464 | 1760998925353.521 | 1760998925353.549 |      8.057 |      0.027 |      8.084 |    0 |    291
  92 | 1760998925352.750 | 1760998925355.656 | 1760998925355.677 |      2.906 |      0.020 |      2.927 |    0 |    292
  93 | 1760998925355.298 | 1760998925357.409 | 1760998925357.456 |      2.110 |      0.047 |      2.158 |    0 |    293
  94 | 1760998925357.175 | 1760998925360.662 | 1760998925360.689 |      3.488 |      0.026 |      3.514 |    0 |    294
  95 | 1760998925359.460 | 1760998925362.851 | 1760998925362.875 |      3.391 |      0.024 |      3.416 |    0 |    295
  96 | 1760998925361.380 | 1760998925365.188 | 1760998925365.216 |      3.808 |      0.028 |      3.836 |    0 |    296
  97 | 1760998925365.809 | 1760998925369.738 | 1760998925369.767 |      3.929 |      0.028 |      3.958 |    0 |    297
  98 | 1760998925368.562 | 1760998925371.898 | 1760998925371.917 |      3.336 |      0.019 |      3.355 |    0 |    298
  99 | 1760998925371.033 | 1760998925373.565 | 1760998925373.593 |      2.532 |      0.027 |      2.560 |    0 |    299

======================================================================
LEGENDA:
  ID         = Identificador da mensagem
  T0_Creation = Timestamp de cria√ß√£o no producer (ms)
  T3_Receive  = Timestamp de recebimento RAW no consumer (ms)
  T4_Deserial = Timestamp ap√≥s desserializa√ß√£o (ms)
  Latency     = Lat√™ncia end-to-end SEM desserializa√ß√£o (ms)
  Deserial    = Tempo de desserializa√ß√£o JSON (ms)
  Total       = Tempo total COM desserializa√ß√£o (ms)
  Part        = Parti√ß√£o do Kafka onde a mensagem foi armazenada
  Offset      = Offset da mensagem na parti√ß√£o
======================================================================
