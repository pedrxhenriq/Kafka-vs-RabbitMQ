======================================================================
KAFKA - RELAT√ìRIO DE LAT√äNCIA END-TO-END
======================================================================

üìñ EXPLICA√á√ÉO DA MEDI√á√ÉO:
----------------------------------------------------------------------
Este teste mede a LAT√äNCIA END-TO-END, que inclui:

  T0 ‚Üí Cria√ß√£o da mensagem no PRODUCER
       - Marca o timestamp antes da serializa√ß√£o JSON
       - Armazenado no campo 'timestamp_ms' da mensagem

  T1 ‚Üí Serializa√ß√£o JSON no producer
       - Convers√£o do dict Python para JSON bytes
       - Feita automaticamente pelo value_serializer

  T2 ‚Üí Envio pela rede + Processamento no Kafka
       - Transmiss√£o TCP/IP (localhost)
       - Persist√™ncia em disco (acks='all')
       - Replica√ß√£o entre brokers (se houver r√©plicas)
       - Armazenamento em parti√ß√£o/offset

  T3 ‚Üí Recebimento RAW no CONSUMER
       - Timestamp capturado ANTES da desserializa√ß√£o
       - Este √© o ponto final da medi√ß√£o
       - IMPORTANTE: value_deserializer=None para controlar isso!

  T4 ‚Üí Desserializa√ß√£o JSON no consumer
       - N√ÉO inclu√≠do na lat√™ncia end-to-end
       - Desserializa√ß√£o manual com json.loads()
       - Medido separadamente para an√°lise

LAT√äNCIA END-TO-END = T3 - T0
(Tempo total desde cria√ß√£o at√© recebimento, sem processamento)
======================================================================

üìä RESUMO ESTAT√çSTICO
----------------------------------------------------------------------
Total de mensagens: 100
Lat√™ncia m√©dia: 17.26 ms
Lat√™ncia m√≠nima: 3.12 ms
Lat√™ncia m√°xima: 111.56 ms
Mediana: 13.94 ms
Desvio padr√£o: 14.09 ms

Percentis:
  P50: 14.02 ms
  P90: 31.00 ms
  P95: 41.79 ms
  P99: 111.56 ms

======================================================================

üìã DADOS DETALHADOS (FORMATO DATAFRAME)
----------------------------------------------------------------------
  ID |     T0_Creation |      T3_Receive |     T4_Deserial |    Latency |   Deserial |      Total | Part | Offset
----------------------------------------------------------------------
   0 | 1762555769446.049 | 1762555769557.604 | 1762555769557.629 |    111.555 |      0.024 |    111.580 |    0 |    300
   1 | 1762555769556.247 | 1762555769560.424 | 1762555769560.481 |      4.177 |      0.057 |      4.234 |    0 |    301
   2 | 1762555769558.896 | 1762555769563.011 | 1762555769563.040 |      4.115 |      0.028 |      4.144 |    0 |    302
   3 | 1762555769562.302 | 1762555769565.419 | 1762555769565.450 |      3.117 |      0.030 |      3.148 |    0 |    303
   4 | 1762555769565.455 | 1762555769569.994 | 1762555769570.031 |      4.539 |      0.036 |      4.576 |    0 |    304
   5 | 1762555769568.111 | 1762555769573.928 | 1762555769573.964 |      5.817 |      0.035 |      5.853 |    0 |    305
   6 | 1762555769571.188 | 1762555769578.854 | 1762555769578.888 |      7.666 |      0.032 |      7.699 |    0 |    306
   7 | 1762555769574.410 | 1762555769582.064 | 1762555769582.103 |      7.654 |      0.038 |      7.693 |    0 |    307
   8 | 1762555769578.319 | 1762555769587.251 | 1762555769587.289 |      8.932 |      0.037 |      8.970 |    0 |    308
   9 | 1762555769581.909 | 1762555769594.010 | 1762555769594.147 |     12.101 |      0.134 |     12.238 |    0 |    309
  10 | 1762555769588.923 | 1762555769605.031 | 1762555769605.172 |     16.108 |      0.135 |     16.249 |    0 |    310
  11 | 1762555769595.008 | 1762555769608.468 | 1762555769608.500 |     13.460 |      0.031 |     13.492 |    0 |    311
  12 | 1762555769598.435 | 1762555769608.603 | 1762555769608.619 |     10.168 |      0.016 |     10.184 |    0 |    312
  13 | 1762555769605.496 | 1762555769612.659 | 1762555769612.695 |      7.163 |      0.035 |      7.198 |    0 |    313
  14 | 1762555769608.271 | 1762555769616.084 | 1762555769616.118 |      7.813 |      0.032 |      7.847 |    0 |    314
  15 | 1762555769615.538 | 1762555769637.906 | 1762555769638.049 |     22.368 |      0.142 |     22.511 |    0 |    315
  16 | 1762555769631.509 | 1762555769646.819 | 1762555769646.856 |     15.309 |      0.036 |     15.346 |    0 |    316
  17 | 1762555769637.337 | 1762555769646.974 | 1762555769646.990 |      9.637 |      0.016 |      9.653 |    0 |    317
  18 | 1762555769642.727 | 1762555769656.475 | 1762555769656.516 |     13.748 |      0.040 |     13.790 |    0 |    318
  19 | 1762555769646.899 | 1762555769660.761 | 1762555769660.795 |     13.862 |      0.034 |     13.896 |    0 |    319
  20 | 1762555769653.981 | 1762555769660.908 | 1762555769660.922 |      6.927 |      0.013 |      6.941 |    0 |    320
  21 | 1762555769657.955 | 1762555769663.936 | 1762555769663.967 |      5.980 |      0.031 |      6.012 |    0 |    321
  22 | 1762555769661.870 | 1762555769679.764 | 1762555769679.797 |     17.894 |      0.032 |     17.927 |    0 |    322
  23 | 1762555769668.217 | 1762555769685.581 | 1762555769685.617 |     17.365 |      0.034 |     17.400 |    0 |    323
  24 | 1762555769680.008 | 1762555769694.031 | 1762555769694.065 |     14.023 |      0.033 |     14.057 |    0 |    324
  25 | 1762555769685.348 | 1762555769711.281 | 1762555769711.319 |     25.933 |      0.036 |     25.970 |    0 |    325
  26 | 1762555769703.347 | 1762555769714.392 | 1762555769714.429 |     11.045 |      0.036 |     11.082 |    0 |    326
  27 | 1762555769711.479 | 1762555769718.928 | 1762555769718.966 |      7.450 |      0.036 |      7.488 |    0 |    327
  28 | 1762555769714.618 | 1762555769737.393 | 1762555769737.428 |     22.775 |      0.034 |     22.810 |    0 |    328
  29 | 1762555769724.400 | 1762555769749.825 | 1762555769749.866 |     25.425 |      0.040 |     25.466 |    0 |    329
  30 | 1762555769735.686 | 1762555769749.985 | 1762555769750.000 |     14.300 |      0.014 |     14.314 |    0 |    330
  31 | 1762555769738.892 | 1762555769769.134 | 1762555769769.176 |     30.241 |      0.041 |     30.284 |    0 |    331
  32 | 1762555769742.848 | 1762555769769.404 | 1762555769769.419 |     26.556 |      0.015 |     26.571 |    0 |    332
  33 | 1762555769747.256 | 1762555769771.027 | 1762555769771.237 |     23.771 |      0.209 |     23.981 |    0 |    333
  34 | 1762555769751.135 | 1762555769771.349 | 1762555769771.371 |     20.214 |      0.022 |     20.237 |    0 |    334
  35 | 1762555769754.376 | 1762555769777.153 | 1762555769777.193 |     22.777 |      0.039 |     22.816 |    0 |    335
  36 | 1762555769758.315 | 1762555769777.269 | 1762555769777.281 |     18.954 |      0.011 |     18.966 |    0 |    336
  37 | 1762555769774.615 | 1762555769813.639 | 1762555769813.678 |     39.025 |      0.037 |     39.063 |    0 |    337
  38 | 1762555769778.847 | 1762555769820.634 | 1762555769820.673 |     41.788 |      0.037 |     41.826 |    0 |    338
  39 | 1762555769816.059 | 1762555769829.856 | 1762555769829.893 |     13.798 |      0.035 |     13.835 |    0 |    339
  40 | 1762555769833.490 | 1762555769843.499 | 1762555769843.531 |     10.008 |      0.031 |     10.041 |    0 |    340
  41 | 1762555769839.455 | 1762555769847.340 | 1762555769847.376 |      7.885 |      0.035 |      7.922 |    0 |    341
  42 | 1762555769843.235 | 1762555769872.975 | 1762555769873.017 |     29.740 |      0.041 |     29.782 |    0 |    342
  43 | 1762555769847.185 | 1762555769879.746 | 1762555769879.843 |     32.561 |      0.095 |     32.658 |    0 |    343
  44 | 1762555769871.746 | 1762555769885.558 | 1762555769885.600 |     13.812 |      0.040 |     13.854 |    0 |    344
  45 | 1762555769879.486 | 1762555769885.697 | 1762555769885.709 |      6.210 |      0.012 |      6.223 |    0 |    345
  46 | 1762555769883.320 | 1762555769889.219 | 1762555769889.256 |      5.899 |      0.036 |      5.936 |    0 |    346
  47 | 1762555769893.438 | 1762555769901.835 | 1762555769901.873 |      8.398 |      0.036 |      8.436 |    0 |    347
  48 | 1762555769899.723 | 1762555769905.908 | 1762555769905.945 |      6.185 |      0.036 |      6.222 |    0 |    348
  49 | 1762555769905.516 | 1762555769921.501 | 1762555769921.538 |     15.985 |      0.036 |     16.022 |    0 |    349
  50 | 1762555769915.599 | 1762555769927.095 | 1762555769927.170 |     11.495 |      0.074 |     11.570 |    0 |    350
  51 | 1762555769924.456 | 1762555769933.412 | 1762555769933.453 |      8.957 |      0.039 |      8.997 |    0 |    351
  52 | 1762555769930.056 | 1762555769947.319 | 1762555769947.364 |     17.263 |      0.043 |     17.308 |    0 |    352
  53 | 1762555769933.407 | 1762555769947.447 | 1762555769947.460 |     14.041 |      0.012 |     14.053 |    0 |    353
  54 | 1762555769937.726 | 1762555769947.514 | 1762555769947.527 |      9.789 |      0.012 |      9.801 |    0 |    354
  55 | 1762555769942.483 | 1762555769951.601 | 1762555769951.636 |      9.118 |      0.034 |      9.153 |    0 |    355
  56 | 1762555769949.632 | 1762555769958.835 | 1762555769958.871 |      9.203 |      0.035 |      9.239 |    0 |    356
  57 | 1762555769958.858 | 1762555769968.191 | 1762555769968.227 |      9.333 |      0.034 |      9.369 |    0 |    357
  58 | 1762555769966.413 | 1762555769987.018 | 1762555769987.072 |     20.605 |      0.053 |     20.660 |    0 |    358
  59 | 1762555769983.587 | 1762555769991.124 | 1762555769991.161 |      7.536 |      0.036 |      7.574 |    0 |    359
  60 | 1762555769988.284 | 1762555769999.955 | 1762555769999.994 |     11.671 |      0.039 |     11.711 |    0 |    360
  61 | 1762555769991.579 | 1762555770000.138 | 1762555770000.160 |      8.560 |      0.021 |      8.582 |    0 |    361
  62 | 1762555770004.657 | 1762555770020.042 | 1762555770020.078 |     15.384 |      0.035 |     15.420 |    0 |    362
  63 | 1762555770014.487 | 1762555770024.967 | 1762555770024.999 |     10.480 |      0.030 |     10.512 |    0 |    363
  64 | 1762555770019.309 | 1762555770034.960 | 1762555770034.994 |     15.651 |      0.033 |     15.685 |    0 |    364
  65 | 1762555770025.823 | 1762555770038.514 | 1762555770038.550 |     12.690 |      0.035 |     12.726 |    0 |    365
  66 | 1762555770040.233 | 1762555770056.673 | 1762555770056.713 |     16.441 |      0.039 |     16.480 |    0 |    366
  67 | 1762555770046.969 | 1762555770064.610 | 1762555770064.643 |     17.641 |      0.031 |     17.673 |    0 |    367
  68 | 1762555770053.337 | 1762555770064.704 | 1762555770064.719 |     11.366 |      0.015 |     11.381 |    0 |    368
  69 | 1762555770060.137 | 1762555770077.533 | 1762555770077.705 |     17.396 |      0.168 |     17.568 |    0 |    369
  70 | 1762555770064.385 | 1762555770083.138 | 1762555770083.179 |     18.753 |      0.039 |     18.794 |    0 |    370
  71 | 1762555770068.663 | 1762555770083.268 | 1762555770083.281 |     14.605 |      0.013 |     14.618 |    0 |    371
  72 | 1762555770074.790 | 1762555770083.305 | 1762555770083.314 |      8.516 |      0.009 |      8.524 |    0 |    372
  73 | 1762555770080.918 | 1762555770098.977 | 1762555770099.015 |     18.058 |      0.037 |     18.096 |    0 |    373
  74 | 1762555770095.345 | 1762555770102.288 | 1762555770102.323 |      6.943 |      0.034 |      6.979 |    0 |    374
  75 | 1762555770100.306 | 1762555770112.939 | 1762555770112.978 |     12.633 |      0.038 |     12.672 |    0 |    375
  76 | 1762555770103.794 | 1762555770122.561 | 1762555770122.594 |     18.767 |      0.031 |     18.799 |    0 |    376
  77 | 1762555770121.154 | 1762555770128.077 | 1762555770128.112 |      6.923 |      0.033 |      6.958 |    0 |    377
  78 | 1762555770127.059 | 1762555770140.279 | 1762555770140.314 |     13.220 |      0.034 |     13.255 |    0 |    378
  79 | 1762555770141.017 | 1762555770177.973 | 1762555770178.024 |     36.957 |      0.050 |     37.008 |    0 |    379
  80 | 1762555770158.158 | 1762555770191.976 | 1762555770192.022 |     33.818 |      0.044 |     33.864 |    0 |    380
  81 | 1762555770188.450 | 1762555770196.564 | 1762555770196.604 |      8.113 |      0.039 |      8.154 |    0 |    381
  82 | 1762555770192.490 | 1762555770200.915 | 1762555770200.958 |      8.424 |      0.041 |      8.467 |    0 |    382
  83 | 1762555770208.361 | 1762555770214.475 | 1762555770214.511 |      6.114 |      0.035 |      6.150 |    0 |    383
  84 | 1762555770213.605 | 1762555770243.561 | 1762555770243.612 |     29.955 |      0.049 |     30.006 |    0 |    384
  85 | 1762555770218.115 | 1762555770267.585 | 1762555770267.628 |     49.470 |      0.041 |     49.513 |    0 |    385
  86 | 1762555770264.293 | 1762555770285.221 | 1762555770285.260 |     20.928 |      0.038 |     20.968 |    0 |    386
  87 | 1762555770272.983 | 1762555770303.984 | 1762555770304.089 |     31.001 |      0.101 |     31.105 |    0 |    387
  88 | 1762555770284.940 | 1762555770304.239 | 1762555770304.255 |     19.299 |      0.015 |     19.315 |    0 |    388
  89 | 1762555770288.792 | 1762555770304.282 | 1762555770304.291 |     15.490 |      0.009 |     15.499 |    0 |    389
  90 | 1762555770293.592 | 1762555770342.006 | 1762555770342.044 |     48.414 |      0.037 |     48.453 |    0 |    390
  91 | 1762555770299.305 | 1762555770355.299 | 1762555770355.340 |     55.994 |      0.040 |     56.035 |    0 |    391
  92 | 1762555770339.625 | 1762555770355.488 | 1762555770355.508 |     15.862 |      0.020 |     15.883 |    0 |    392
  93 | 1762555770345.247 | 1762555770365.875 | 1762555770365.989 |     20.627 |      0.110 |     20.742 |    0 |    393
  94 | 1762555770355.126 | 1762555770381.027 | 1762555770381.072 |     25.901 |      0.044 |     25.946 |    0 |    394
  95 | 1762555770375.468 | 1762555770405.414 | 1762555770405.455 |     29.947 |      0.039 |     29.987 |    0 |    395
  96 | 1762555770399.904 | 1762555770420.323 | 1762555770420.415 |     20.420 |      0.090 |     20.511 |    0 |    396
  97 | 1762555770415.314 | 1762555770433.627 | 1762555770433.673 |     18.313 |      0.044 |     18.359 |    0 |    397
  98 | 1762555770429.149 | 1762555770437.133 | 1762555770437.193 |      7.984 |      0.058 |      8.043 |    0 |    398
  99 | 1762555770434.620 | 1762555770442.502 | 1762555770442.542 |      7.883 |      0.037 |      7.922 |    0 |    399

======================================================================
LEGENDA:
  ID         = Identificador da mensagem
  T0_Creation = Timestamp de cria√ß√£o no producer (ms)
  T3_Receive  = Timestamp de recebimento RAW no consumer (ms)
  T4_Deserial = Timestamp ap√≥s desserializa√ß√£o (ms)
  Latency     = Lat√™ncia end-to-end SEM desserializa√ß√£o (ms)
  Deserial    = Tempo de desserializa√ß√£o JSON (ms)
  Total       = Tempo total COM desserializa√ß√£o (ms)
  Part        = Parti√ß√£o do Kafka onde a mensagem foi armazenada
  Offset      = Offset da mensagem na parti√ß√£o
======================================================================
